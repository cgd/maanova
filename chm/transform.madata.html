<html><head><title>Micro Array experiment data transformation</title>
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>transform.madata(maanova)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   transform.madata">
<param name="keyword" value="R:   transform.rawdata">
<param name="keyword" value=" Micro Array experiment data transformation">
</object>


<h2>Micro Array experiment data transformation</h2>


<h3>Description</h3>

<p>
This is the function to transform the Micro Array experiment data
based on the given method.
</p>


<h3>Usage</h3>

<pre>
transform.madata(`_data`,method=c("shift","glowess","rlowess","linlog","linlogshift"),
       lolim, uplim, f=0.1, iter=3, degree=1, cg=0.3, cr=0.3, n.bin=10,
       draw=c("screen", "dev", "off"), ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>_data</code></td>
<td>
An object of class <code>madata</code> or <code>rawdata</code>.</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
The smoothing method.</td></tr>
<tr valign="top"><td><code>lolim</code></td>
<td>
Low shift limit. If this argument is missing, the negative
of the minimum element in the pmt data is used.</td></tr>
<tr valign="top"><td><code>uplim</code></td>
<td>
High shift limit. If this argument is missing, the minimum
element in the pmt data is used. lolim and uplim are applicable only if
the method is "shift" or "linlogshift".</td></tr>
<tr valign="top"><td><code>f</code></td>
<td>
The smoother span. This gives the proportion of points in the
plot which influence the smooth at each value. Larger values give
more smoothness. It is equivalent to the "span" parameter in
<code><a onclick="findlink('modreg', 'loess.html')" style="text-decoration: underline; color: blue; cursor: hand">loess</a></code>.</td></tr>
<tr valign="top"><td><code>iter</code></td>
<td>
The number of robustifying iterations which should be
performed. Using smaller values of iter will make lowess run
faster.</td></tr>
<tr valign="top"><td><code>degree</code></td>
<td>
The degree of the polynomials to be used in loess, up to
2. This is used when method is "glowess" or "rlowess".</td></tr>
<tr valign="top"><td><code>cg</code></td>
<td>
Percentage of genes to be transformed linearly for the green
channel.</td></tr>
<tr valign="top"><td><code>cr</code></td>
<td>
Percentage of genes to be transformed linearly for the red
channel.</td></tr>
<tr valign="top"><td><code>n.bin</code></td>
<td>
Number of bins for calculating the variance after
linlogShift.</td></tr>
<tr valign="top"><td><code>draw</code></td>
<td>
Where to plot the transformation plots. "off" means
no plot. "screen" means to display the plots on screen then
x11() (in Unix/Windows) or
macintosh() (in Mac) will be called inside the function.
"dev" means to output the plots to the current device. User can use
this option to output the plot to a file. Default option is
"screen". </td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
Ignored at this point.</td></tr>
</table>

<h3>Details</h3>

<p>
The smoothing methods include:
</p>
<p>
shift &ndash; the calculation of offset is based on the minimum
sum of absolute deviations (SAD). Each array will have its own offset
value. The data after shift cannot be smaller than 1.
</p>
<p>
glowess &ndash; Intensity-based lowess. This method is to smooth the scatter
plot of Ratio (R/G) versus Intensity (R*G). The formula in the fitting
is ratio ~ intensity. 
</p>
<p>
rlowess &ndash; Joint lowess. This method is to smooth the scatter plot
of Ratio versus Intensity and grid locations. It is the joint of
intensity-based lowess and spatial loess. You have to have the grid
location for every spot in order to use this method. The formula in
fitting is ratio ~ intesity + row + col. 
</p>
<p>
linlog &ndash; Linear-log transformation.
</p>
<p>
linlogshift &ndash; Linear-log shift transformation.
</p>
<p>
Previously, intensity lowess was called global lowess and joint lowess
was called regional lowess. So I use "glowess" and "rlowess" in the
method. Although the method names doesn't make too much sense, I will
keep them for the reason of backward compatibility.
</p>
<p>
If you have replicated spots and want to collapse them in
<code><a createData.html>createData</a></code> by providing avgreps=1 or 2, you will
lose grid information and joint lowess will be unavailable.
</p>
<p>
This function works on both <code>rawdata</code> and <code>madata</code> objects.
For <code>rawdata</code>, the result transformed data will be on the raw
scale. For <code>madata</code>, the result transformed data will be on log2
based scale.
</p>
<p>
Note that this function is only working for two-dye array at this
time.
</p>


<h3>Value</h3>

<p>
The return value is an object of class <code>madata</code> or
<code>rawdata</code>. Compared with the input object, the following fields
are changed:
<ul>
<li>Field <code>data</code> is the transformed data.
<li>Field <code>TransformMethod</code> will be the transformation method
applied.
</ul>

<h3>Author(s)</h3>

<p>
Hao Wu
</p>


<h3>References</h3>

<p>
Kerr and Churchill(2001), Statistical design and the analysis of gene
expression microarrays, <EM>Genetical Research</EM>, <B>77</B>:123-128.
</p>
<p>
Kerr, Martin and Churchill(2000), Analysis of variance for gene expression
microarray data, <EM>Journal of Computational Biology</EM>,
<B>7</B>:819-837.
</p>
<p>
Cui, Kerr and Churchill(2002), Data transformations for cDNA
Microarray data, submitted, find manuscript in www.jax.org/research/churchill.
</p>


<h3>See Also</h3>

<p>
<code><a onclick="findlink('modreg', 'loess.html')" style="text-decoration: underline; color: blue; cursor: hand">loess</a></code>
</p>


<h3>Examples</h3>

<pre>
# load in data
data(kidney)
# do regional loess on raw data
## Not run: 
raw.lowess &lt;- transform.madata(kidney.raw, method="rlowess")
graphics.off()

# make data object and do normalization on it
# create data object with collapsing replicates
data1&lt;-createData(kidney.raw)
# do shift without displaying the plot
data1.shift &lt;- transform.madata(data1, method="shift", lolim=-50, uplim=50,
         draw="off")

# do global lowess and output the plots to a postscript file
postscript(file="glowess.ps")
data1.glowess &lt;- transform.madata(data1, method="glowess", draw="dev")
graphics.off()

# do linear-log
data1.linlog &lt;- transform.madata(data1, method="linlog")
graphics.off()

# do linear-log shift
data1.linlogshift &lt;- transform.madata(data1, method="linlogshift", lolim=-50,
  uplim=50)
graphics.off()
## End(Not run)
</pre>

<script Language="JScript">
function findlink(pkg, fn) {
var Y, link;
Y = location.href.lastIndexOf("\\") + 1;
link = location.href.substring(0, Y);
link = link + "../../" + pkg + "/chtml/" + pkg + ".chm::/" + fn;
location.href = link;
}
</script>


<hr><div align="center">[Package <em>maanova</em> version 1.2.0 <a href="00Index.html">Index]</a></div>

</body></html>
