<html><head><title>Fit ANOVA model for Micro Array experiment</title>
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>fitmaanova(maanova)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   fitmaanova">
<param name="keyword" value=" Fit ANOVA model for Micro Array experiment">
</object>


<h2>Fit ANOVA model for Micro Array experiment</h2>


<h3>Description</h3>

<p>
This is the function to fit the ANOVA model for Micro Array
experiment. Given the data and model object, this function will fit the
regression gene by gene and output the estimates, variance components
for random terms, fitted values, etc.
For a mixed effect models, the output estimates will be BLUE and BLUP.
</p>
<p>
Note that the calculation could be very slow for mixed effect
models. The computational time depends on the number of genes, number
of arrays and the size of the random variables (dimension of Z
matrix).
</p>


<h3>Usage</h3>

<pre>
fitmaanova(madata, mamodel, inits20,
           method=c("REML","ML","MINQE-I","MINQE-UI", "noest"),
           verbose=TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>madata</code></td>
<td>
An object of class <code>madata</code>.</td></tr>
<tr valign="top"><td><code>mamodel</code></td>
<td>
An object of class <code>mamodel</code>.</td></tr>
<tr valign="top"><td><code>inits20</code></td>
<td>
The initial value for variance components. This should
be a matrix with number of rows equals to the number of genes and
number of columns equals to the number of random terms in the model.
Good initial values will greatly speed up the calculation. If not
given, it will be calculated based on the corresponding fixed
model.</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
The method used to solve the Mixed Model
Equation. Available options includes: "ML" for maximum liklihood;
"REML" for restricted maximum liklihood; "MINQE-I" and "MINQE-UI"
are for minimum norm and "noest" for no estimate
for variance component (use the initial value). Both "ML" and "REML"
use method of scoring algorithm to solve MME iteratively. "noest" skips the
iteration and will be significantly faster (but 
accurate). Default method is "REML". For details about fitting mixed
effects models, read the "Fitting mixed Effects model" section.
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
A logical value to indicate whether to display some
message for calculation progress.</td></tr>
</table>

<h3>Value</h3>

<p>
An object of class <code>maanova</code>, which is a list of following
components:
</p>
<table summary="R argblock">
<tr valign="top"><td><code>yhat</code></td>
<td>
Fitted pmt value which has the same dimension as the input
pmt data</td></tr>
<tr valign="top"><td><code>S2</code></td>
<td>
Variance components for the random terms. It is a matrix
with number of rows equals to the number of genes and number of
columns equals to the number of random terms. Note that for fixed
effect model, S2 is a one column vector for error's variance.</td></tr>
<tr valign="top"><td><code>G</code></td>
<td>
Gene effects. A vector with the same length as the number
of genes.</td></tr>
<tr valign="top"><td><code>reference</code></td>
<td>
The estimates for reference sample. If there is no
reference sample specified in the design, this field will be absent
in the output object.</td></tr>
<tr valign="top"><td><code>S2.level</code></td>
<td>
A list of strings to indicate the order of the S2
field. Note that the last column of S2 is always the error's
variance. S2.level is only for the non-error terms.
For example, if there are three columns in S2 and S2.level is
c("Strain", "Diet"), then the three columns of S2
correspond to the variances of Strain, Diet and error
respectively for each gene. </td></tr>
<tr valign="top"><td><code>Others</code></td>
<td>
Estimates (or BLUE/BLUP for mixed effect model) for
the terms in model. There will be XXX.level field for each term
representing the order of the estimates (similar to S2.level).</td></tr>
<tr valign="top"><td><code>flag</code></td>
<td>
A vector to indicate whether there is bad spot for this 
gene. 0 means no bad spot and 1 means has bad spot. If there is no
flag information in input data, this field will not be available.</td></tr>
<tr valign="top"><td><code>model</code></td>
<td>
The model object used for this fitting.</td></tr>
</table>

<h3>Fitting mixed Effects model</h3>

<p>
Fitting mixed effects models needs a lot of computation. A good
starting value for the variances is very important. This function
first treats all random factors as fixed and fits a fixed effects
model. Then variances for random factors are calculated and used as
the initial values for mixed effects model fitting. 
</p>
<p>
There are several methods available for fitting the mixed effects
model. "noest" does not really fit the mixed effects model. It takes
the initial variance and solve mixed model equatinos to get the
estimates (BLUE and BLUP). "MINQE-I" and "MINQE-UI" are based on
minimum norm unbiased estimators. It is can be thought as a first
iterate solution of "ML" and "REML", respectively. "ML" and "REML" are
based on maximum likelihood and restricted maximum likelihood. Both of
them need to be solved iteratively so they are verly slow to
compute. For "ML" and "REML", a MINQUE estimates is used as
the starting value.  "Method of scoring" is used as the iteratively
algorithm to solve ML and REML. "Method of scoring" algorithm is
similar to New-Raphson method except that it uses the expected value
of Hessian (second derivative matrix of the objective function)
instead of Hessian itself. Method of scoring is more robust to poor
starting values and the Hessian is easier to calculate than
Newton-Raphson.
</p>
<p>
For more mathematical details please read Searle et al.
</p>


<h3>Author(s)</h3>

<p>
Hao Wu
</p>


<h3>References</h3>

<p>
Kerr and Churchill(2001), Statistical design and the analysis of gene
expression microarrays, <EM>Genetical Research</EM>, <B>77</B>:123-128.
</p>
<p>
Kerr, Martin and Churchill(2000), Analysis of variance for gene expression
microarray data, <EM>Journal of Computational Biology</EM>,
<B>7</B>:819-837.
</p>
<p>
Searle, Casella and McCulloch, <EM>Variance Components</EM>, John Wiley
and sons, Inc.
</p>


<h3>See Also</h3>

<p>
<code><a makeModel.html>makeModel</a></code>, <code><a matest.html>matest</a></code>
</p>


<h3>Examples</h3>

<pre>
###################################
# fixed model fitting
###################################
# load in Paigen's data
data(paigen)
# make data object with rep 2
paigen &lt;- createData(paigen.raw, 2)
# Note that the data is normalized so normalization is skipped
# full model
model.full.fix &lt;- makeModel(data=paigen,
      formula=~Dye+Array+Spot+Strain+Diet+Strain:Diet)
anova.full.fix &lt;- fitmaanova(paigen, model.full.fix)
# residual plot
resiplot(paigen, anova.full.fix)

#######################################
# mixed model fitting -
# Array, Spot and biological
# replicates are random effects. 
# This may take a while to finish
#######################################
## Not run: 
model.full.mix &lt;- makeModel(data=paigen,
      formula=~Dye+Array+Spot+Strain+Diet+Strain:Diet+Sample,
      random=~Array+Spot+Sample)
anova.full.mix &lt;- fitmaanova(paigen, model.full.mix, method="REML")
# residual plot
resiplot(paigen, anova.full.mix)
# variance component plot
varplot(anova.full.mix)
## End(Not run)
</pre>



<hr><div align="center">[Package <em>maanova</em> version 1.2.0 <a href="00Index.html">Index]</a></div>

</body></html>
