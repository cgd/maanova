<html><head><title>Volcano plot for F test results</title>
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>volcano(maanova)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   volcano">
<param name="keyword" value=" Volcano plot for F test results">
</object>


<h2>Volcano plot for F test results</h2>


<h3>Description</h3>

<p>
This function generates a volcano-like plot given the F test results.
</p>


<h3>Usage</h3>

<pre>
volcano(matestobj, threshold=c(0.001,0.05,0.05,0.05),
        method=c("unadj","unadj","unadj","unadj"), title="Volcano Plot",
        highlight.flag=TRUE, onScreen=TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>matestobj</code></td>
<td>
An object of class <code>matest</code>.</td></tr>
<tr valign="top"><td><code>threshold</code></td>
<td>
A vector of four double values to indicate the
thresholds for four F tests. The values should be between 0 and 1.
Note that you need to put four values here even if you don't have
all four F tests in matestobj.</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
A flag indicating to use which P values to generate the
plot and select genes. This is a vector with four elements, which
corresponds to four F tests. Each element should be one of the
following five selections:
<ul>
<dt>"unadj"</dt><dd>Unadjusted tabulated P values.</dd>
<dt>"nominal"</dt><dd>Nominal permutation P values.</dd>
<dt>"fwer"</dt><dd>FWER one-step adjusted P values.</dd>
<dt>"fdr"</dt><dd>FDR adjusted tabulated P values.</dd>
<dt>"fdrperm"</dt><dd>FDR adjusted nominal permutation P values.</dd>
</ul>
Default value is c("unadj", "unadj", "unadj", "unadj") which means to use
tabulated P values for all four tests.
<br>
Note that you need to put four values here even if you don't have
all four F tests in matestobj.</td></tr>
<tr valign="top"><td><code>title</code></td>
<td>
Figure title. Default is "Volcano Plot".</td></tr>
<tr valign="top"><td><code>highlight.flag</code></td>
<td>
A logical value to indicate whether to highlight
the genes with bad spots or not.</td></tr>
<tr valign="top"><td><code>onScreen</code></td>
<td>
A logical value to represent whether to display the
plots on screen or not. If TRUE, the figure will be plotted on the
screen. Otherwise, it will plot the figure on the current device.
Default is TRUE.</td></tr>
</table>

<h3>Details</h3>

<p>
This function allows one to visualize the results from the F or T 
tests. The figure looks like an erupting volcano. There will be one
plot For F-test result and multiple plots for T-test result, each plot
crresponds to one T-test. You must have F1 test result in the input
object in order to do volcano plot. 
</p>
<p>
On the plot, the y-axis value is -log10(P-value) for the F1 test.
The x-axis value is propotional to the fold changes. 
A horizontal line represents the significance threshold of
the F1 test. The red dots are the genes selected by the F2
test (if there's F2 test result). 
The green dots are the genes selected by the F3
test (if there's F3 test result).
The orange dots are the genes
selected by the Fs test (if there's Fs test result). If there
is flag information in the data and the user wants to highlight the
flagged genes, the genes with any bad spots will be circled by a black
circle.
</p>


<h3>Value</h3>

<p>
For F-test volcano plot, it returns an object which is a list of the
following four fields: 
</p>
<table summary="R argblock">
<tr valign="top"><td><code>idx.F1</code></td>
<td>
The significant genes selected by F1 test.</td></tr>
<tr valign="top"><td><code>idx.F2</code></td>
<td>
The significant genes selected by F2 test.</td></tr>
<tr valign="top"><td><code>idx.F3</code></td>
<td>
The significant genes selected by F3 test.</td></tr>
<tr valign="top"><td><code>idx.Fs</code></td>
<td>
The significant genes selected by Fs test.</td></tr>
<tr valign="top"><td><code>idx.all</code></td>
<td>
The significant genes selected by all four F tests.</td></tr>
</table>
<p>

<br>
For T-test volcano plot, it returns an array of the above object. Each
element in the array corresponds to one T-test.</p>

<h3>Author(s)</h3>

<p>
Hao Wu
</p>


<h3>Examples</h3>

<pre>
data(paigen)
paigen &lt;- createData(paigen.raw, n.rep=2)

# make model without interaction
model.noint.fix &lt;- makeModel(data=paigen, formula=~Array+Dye+Spot+Strain+Diet)

# F-test strain effect
## Not run: 
test.strain.fix &lt;- matest(paigen, model.noint.fix, term="Strain", n.perm=500,
        shuffle.method="resid", test.method=rep(1,4))
# volcano plot
idx.strain.fix &lt;- volcano(test.strain.fix, title="Strain test - fixed model")

# T-test all pairwise comparison on strain
C &lt;- matrix(c(1,-1,0,1,0,-1, 0,1,-1), nrow=3, byrow=TRUE)
ttest.strain.fix &lt;- matest(paigen, model.noint.fix, term="Strain",
         Contrast=C, n.perm=500, test.method=rep(1,4))
# volcano plot
volcano(ttest.strain.fix)
## End(Not run)
</pre>



<hr><div align="center">[Package <em>maanova</em> version 1.2.0 <a href="00Index.html">Index]</a></div>

</body></html>
