<html><head><title>Make model object for N-dye Micro Array experiment</title>
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>makeModel(maanova)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   makeModel">
<param name="keyword" value=" Make model object for N-dye Micro Array experiment">
</object>


<h2>Make model object for N-dye Micro Array experiment</h2>


<h3>Description</h3>

<p>
This is the function to make an object of class <code>mamodel</code> 
for a Micro Array experiment.
</p>


<h3>Usage</h3>

<pre>
makeModel(data, design, formula, random=~1, covariate=~1)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
An object of class <code>madata</code>.</td></tr>
<tr valign="top"><td><code>design</code></td>
<td>
A data frame representing the experimental design. By
default, it is a field in madata. But you can always make a data
frame and pass it to the function.</td></tr>
<tr valign="top"><td><code>formula</code></td>
<td>
The ANOVA model formula.</td></tr>
<tr valign="top"><td><code>random</code></td>
<td>
The formula for random terms. ~1 means only the residual
is random (fixed model). Note that all random terms should be in the
ANOVA model formula.</td></tr>
<tr valign="top"><td><code>covariate</code></td>
<td>
The formula for covariates. ~1 means no covariates.
The covariates will be continuous values in the design matrix.</td></tr>
</table>

<h3>Details</h3>

<p>
The user needs to specify the ANOVA model by formula. It can be a fixed or
mixed effect model. This function will check the validity of the data,
calculate some parameters, construct and design matrices and wrap up
everything together to create an output object.
</p>
<p>
The model formula is for a gene-specific model. All terms in the
formula should be corresponding to the factor names in design except
"Spot" and "Label". "Spot" represents the spotting effect and "Label"
represents the labelling effects. They are from the within slide
technical replicates. If there is no replicated spots, These two terms
cannot be fitted. Also these two terms cannot be fitted for one-dye
system (e.g., affymetric arrays). (Note that Dye effect should not be
fitted in one-dye system).
</p>
<p>
A typical formual will be like "~Array+Dye+Sample", which means you
want to fit Array effect, Dye effect and Sample effect in the ANOVA
model. In this case, you need to have Array, Dye and Sample columns in
your input design file. Make sure you have enough degree of
freedom when making a model. Also you need to be careful about
confounding problem.
</p>
<p>
If you have multiple factors in your experiment, you can specify the main
and interaction effect in the formula. At this time, only two-way
interactions are allowed.
</p>
<p>
For most mixed effect models, Array should be treated as random
factor. Sample should be treated as random if you have biological
replicates. Note that the reference sample (0's in Sample) will
always be treated as fixed even if you specify Sample as random.
</p>


<h3>Value</h3>

<p>
An object of class <code>mamodel</code> with the following fields:
</p>
<table summary="R argblock">
<tr valign="top"><td><code>X</code></td>
<td>
Design matrix for fixed terms.</td></tr>
<tr valign="top"><td><code>dimX</code></td>
<td>
Number of columns in X for each fixed term.</td></tr>
<tr valign="top"><td><code>Z</code></td>
<td>
Design matrix for random terms. This will be absent for fixed
model.</td></tr>
<tr valign="top"><td><code>dimZ</code></td>
<td>
Number of columns in Z for each random term.This will be
absent for fixed model.</td></tr>
<tr valign="top"><td><code>df</code></td>
<td>
The degree of freedom for each term in the model.</td></tr>
<tr valign="top"><td><code>mixed</code></td>
<td>
An integer to indicate whether this is a fixed or mixed
effect model. 0 means fixed and 1 means mixed.</td></tr>
<tr valign="top"><td><code>design</code></td>
<td>
The input experimental design as a data frame.</td></tr>
<tr valign="top"><td><code>formula</code></td>
<td>
The input model formula.</td></tr>
<tr valign="top"><td><code>random</code></td>
<td>
The input formula for random terms.</td></tr>
<tr valign="top"><td><code>covariate</code></td>
<td>
The input formula for covariates.</td></tr>
</table>

<h3>Author(s)</h3>

<p>
Hao Wu
</p>


<h3>References</h3>

<p>
Kerr and Churchill(2001), Statistical design and the analysis of gene
expression microarrays, <EM>Genetical Research</EM>, <B>77</B>:123-128.
</p>
<p>
Kerr, Martin and Churchill(2000), Analysis of variance for gene expression
microarray data, <EM>Journal of Computational Biology</EM>,
<B>7</B>:819-837.
</p>


<h3>Examples</h3>

<pre>
#load in data
data(paigen)
# make data object with rep 2
paigen &lt;- createData(paigen.raw, 2)
# make full model for fixed effect model
model.full.fix &lt;- makeModel(data=paigen,
      formula=~Dye+Array+Spot+Strain+Diet+Strain:Diet)
summary(model.full.fix)
# make full model for mixed effect model
model.full.mix &lt;- makeModel(data=paigen,
      formula=~Dye+Array+Spot+Strain+Diet+Strain:Diet+Sample,
      random=~Array+Spot+Sample)
summary(model.full.mix)
</pre>



<hr><div align="center">[Package <em>maanova</em> version 1.2.0 <a href="00Index.html">Index]</a></div>

</body></html>
