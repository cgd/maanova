<html><head><title>Clustering analysis for Micro Array experiment</title>
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>macluster(maanova)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   macluster">
<param name="keyword" value=" Clustering analysis for Micro Array experiment">
</object>


<h2>Clustering analysis for Micro Array experiment</h2>


<h3>Description</h3>

<p>
This function bootstraps K-means or hierarchical clusters and builds a 
consensus tree (consensus group for K-means) from the bootstrap
result.
</p>


<h3>Usage</h3>

<pre>
macluster(anovaobj, term, idx.gene, what = c("gene", "sample"), 
    method = c("hc", "kmean"), dist.method = "correlation",
    hc.method = "ward", kmean.ngroups, n.perm = 100)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>anovaobj</code></td>
<td>
The result object for fitting ANOVA model.</td></tr>
<tr valign="top"><td><code>term</code></td>
<td>
The factor (in formula) used in clustering. The expression
level for this term will be used in clustering. This term has to 
correspond to the gene list, e.g, idx.gene in this function. The
gene list should be the significant hits in testing this term.</td></tr>
<tr valign="top"><td><code>idx.gene</code></td>
<td>
A vector indicating the list of differential expressed
genes. The expression level of these genes will be used to construct
the cluster.</td></tr>
<tr valign="top"><td><code>what</code></td>
<td>
What to be clustered, either gene or sample.</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
The clustering method. Right now hierarchical clustering
("hc") and K-means ("kmean") are available.</td></tr>
<tr valign="top"><td><code>dist.method</code></td>
<td>
Distance measure to be used in hierarchical
clustering. Besides the methods listed in <code><a onclick="findlink('mva', 'dist.html')" style="text-decoration: underline; color: blue; cursor: hand">dist</a></code>,
there is a new method "correlation" (default). The "correlation"
distance equals to (1 - $r^2$), where r is the sample correlation
between observations. </td></tr>
<tr valign="top"><td><code>hc.method</code></td>
<td>
The agglomeration method to be used in hierarchical
clustering. See <code><a onclick="findlink('mva', 'hclust.html')" style="text-decoration: underline; color: blue; cursor: hand">hclust</a></code> for detail.</td></tr>
<tr valign="top"><td><code>kmean.ngroups</code></td>
<td>
The number of groups for K-means cluster.</td></tr>
<tr valign="top"><td><code>n.perm</code></td>
<td>
Number of bootstraps. If it is 1, this function will
cluster the observed data. If it is bigger than 1, a bootstrap
will be performed.</td></tr>
</table>

<h3>Details</h3>

<p>
Normally after the F test, user can select a list of differential expressed
genes. The next step is to investiagte the relationship among these
genes. Using the expression levels of these genes, the user can cluster the
genes or the samples using either hierarchical or K-means clustering
algorithm. In order to evaluate the stability of the relationship,
this function bootstraps the data, refits the model and recluster the
genes/samples. Then for a certain number of bootstrap iterations, say,
1000, we have 1000 cluster results. We can use
<code><a consensus.html>consensus</a></code> to  build the consensus tree from
these 1000 trees. 
</p>
<p>
Note that if you have a large number (say, more than 100) of
genes/samples to cluster, hierarchical clustering could be very
unstable. A slight change in the data can result in a big change in the
tree structure. In that case, K-means will give better results.
</p>


<h3>Value</h3>

<p>
An object of class <code>macluster</code>.</p>

<h3>Author(s)</h3>

<p>
Hao Wu
</p>


<h3>See Also</h3>

<p>
<code><a onclick="findlink('mva', 'hclust.html')" style="text-decoration: underline; color: blue; cursor: hand">hclust</a></code>, <code><a onclick="findlink('mva', 'kmeans.html')" style="text-decoration: underline; color: blue; cursor: hand">kmeans</a></code>,
<code><a consensus.html>consensus</a></code>
</p>


<h3>Examples</h3>

<pre>
# load in data
data(paigen)
# make data object with rep 2
paigen &lt;- createData(paigen.raw, 2)
# make interactive model
model.int.fix &lt;- makeModel(data=paigen,
      formula=~Dye+Array+Strain+Diet+Strain:Diet)
# fit ANOVA model
anova.int &lt;- fitmaanova(paigen, model.int.fix)
# test interaction effect 
## Not run: test.int.fix &lt;- matest(paigen, model.int.fix, term="Strain:Diet", n.perm=100)
# pick significant genes - pick the genes selected by Fs test
idx &lt;- volcano(test.int.fix)$idx.Fs

# do k-means cluster on genes
gene.cluster &lt;- macluster(anova.int, "Strain:Diet", idx, "gene",
    "kmean", kmean.ngroups=5)
# get the consensus group
consensus(gene.cluster, 0.5)

# HC cluster on samples
sample.cluster &lt;- macluster(anova.int, "Strain:Diet", idx, "sample","hc")
# get the consensus group
consensus(sample.cluster, 0.5)## End(Not run)
</pre>

<script Language="JScript">
function findlink(pkg, fn) {
var Y, link;
Y = location.href.lastIndexOf("\\") + 1;
link = location.href.substring(0, Y);
link = link + "../../" + pkg + "/chtml/" + pkg + ".chm::/" + fn;
location.href = link;
}
</script>


<hr><div align="center">[Package <em>maanova</em> version 1.2.0 <a href="00Index.html">Index]</a></div>

</body></html>
